<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes, shrink-to-fit=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ä¹é£Ÿå ‚é¢åŒ…åº—</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #FFD93D;
            --secondary-color: #FFB347;
            --accent-color: #FF6B6B;
            --text-dark: #2C3E50;
            --text-light: #7F8C8D;
            --bg-light: #FFF8E1;
            --bg-white: #FFFFFF;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --shadow-hover: 0 4px 20px rgba(0,0,0,0.15);
            --border-radius: 12px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #FFD93D 0%, #FFB347 100%);
            min-height: 100vh;
            min-height: -webkit-fill-available; /* iOS Safari å…¼å®¹ */
            color: var(--text-dark);
            margin: 0;
            padding: 0;
            width: 100%;
            overflow-x: hidden;
            overflow-y: auto; /* ç¡®ä¿å¯ä»¥å‚ç›´æ»šåŠ¨ */
            font-size: 16px; /* é˜²æ­¢iOSè‡ªåŠ¨ç¼©æ”¾ */
            -webkit-text-size-adjust: 100%;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            min-height: -webkit-fill-available; /* iOS Safari å…¼å®¹ */
            display: flex;
            flex-direction: column;
            width: 100%;
            overflow-x: hidden;
            position: relative;
        }

        /* Header Styles */
        header {
            background: var(--bg-white);
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mode-switcher {
            display: flex;
            background: var(--bg-light);
            border-radius: 25px;
            padding: 5px;
        }

        .mode-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            min-height: 44px; /* ç§»åŠ¨ç«¯è§¦æ‘¸å‹å¥½ */
            touch-action: manipulation;
        }

        .mode-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* Main Content */
        main {
            flex: 1;
            background: var(--bg-white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            overflow-y: auto;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 250px;
            background: var(--bg-light);
            padding: 20px 0;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            border: none;
            background: transparent;
            width: 100%;
            text-align: left;
            font-size: 15px;
            color: var(--text-dark);
            min-height: 44px; /* ç§»åŠ¨ç«¯è§¦æ‘¸å‹å¥½ */
            touch-action: manipulation;
        }

        .nav-item:hover {
            background: rgba(255, 107, 107, 0.1);
            padding-left: 25px;
        }

        .nav-item.active {
            background: var(--primary-color);
            color: white;
        }

        /* Content Area */
        .content {
            flex: 1;
            padding: 0 20px;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .product-card {
            background: var(--bg-white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }

        /* å•†å“å›¾ç‰‡å®¹å™¨ */
        .product-image-container {
            position: relative;
            width: 100%;
            height: 250px;
            overflow: hidden;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        }

        /* å•†å“å›¾ç‰‡ */
        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
            display: block;
        }

        .product-card:hover .product-image {
            transform: scale(1.05);
        }

        .product-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: var(--shadow);
            z-index: 2;
        }

        .product-stock {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            z-index: 2;
        }

        .product-info {
            padding: 20px;
        }

        .product-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .product-description {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 10px;
            line-height: 1.4;
            min-height: 40px;
        }

        .product-notes {
            font-size: 12px;
            color: #FFB347;
            background: rgba(255, 179, 71, 0.1);
            padding: 8px 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 3px solid #FFB347;
            line-height: 1.4;
        }

        /* å£å‘³é€‰æ‹©æ ·å¼ */
        .flavor-selector {
            margin-bottom: 15px;
        }

        .flavor-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-dark);
            margin-bottom: 8px;
            display: block;
        }

        .flavor-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .flavor-option {
            padding: 6px 12px;
            border: 2px solid #ddd;
            border-radius: 20px;
            background: var(--bg-white);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 500;
            min-width: 80px;
            text-align: center;
        }

        .flavor-option:hover {
            border-color: var(--primary-color);
            background: rgba(255, 217, 61, 0.1);
        }

        .flavor-option.selected {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }

        .flavor-price {
            font-size: 10px;
            color: var(--text-light);
            margin-top: 2px;
        }

        .product-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .product-price {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary-color);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .add-to-cart {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);
        }

        .add-to-cart:hover:not(:disabled) {
            background: #FF5252;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }

        .add-to-cart:active:not(:disabled) {
            transform: translateY(0);
        }

        .add-to-cart:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* è´­ç‰©è½¦æ ·å¼ */
        .cart-container {
            margin-top: 20px;
        }

        .cart-item {
            background: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s ease;
        }

        .cart-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            object-fit: cover;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-dark);
        }

        .cart-item-flavor {
            font-size: 14px;
            color: var(--text-light);
            margin-bottom: 8px;
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
            background: var(--bg-white);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .quantity-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .quantity-input {
            width: 50px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
            font-size: 14px;
        }

        .cart-item-price {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
            margin-right: 20px;
        }

        .cart-total {
            background: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--shadow);
            text-align: right;
        }

        .total-amount {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .checkout-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(255, 107, 107, 0.3);
        }

        .checkout-btn:hover {
            background: #FF5252;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .submit-order-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(255, 217, 61, 0.3);
        }

        .submit-order-btn:hover {
            background: #FFB347;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 179, 71, 0.4);
        }

        /* å•†å®¶ç«¯æ ·å¼ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: var(--bg-white);
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-light);
        }

        .inventory-table {
            margin-top: 20px;
            background: var(--bg-white);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .inventory-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .inventory-table th,
        .inventory-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .inventory-table th {
            background: var(--bg-light);
            font-weight: 600;
            color: var(--text-dark);
        }

        .inventory-table tr:hover {
            background: rgba(255, 107, 107, 0.05);
        }

        .save-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(255, 217, 61, 0.3);
        }

        .save-btn:hover {
            background: #FFB347;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 179, 71, 0.4);
        }

        .small-btn {
            padding: 6px 12px;
            border: 1px solid var(--primary-color);
            border-radius: 15px;
            background: var(--bg-white);
            color: var(--primary-color);
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            touch-action: manipulation;
        }

        .small-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .delete-btn {
            border-color: #FF5252;
            color: #FF5252;
        }

        .delete-btn:hover {
            background: #FF5252;
            color: white;
        }

        .order-notes {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 217, 61, 0.1);
            border-radius: 8px;
            border-left: 3px solid var(--primary-color);
        }

        .order-notes label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-dark);
        }

        .order-notes textarea {
            width: 100%;
            min-height: 80px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .order-notes textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            /* ç§»åŠ¨ç«¯åŸºç¡€ä¼˜åŒ– */
            body {
                font-size: 14px;
                min-height: 100vh;
                min-height: -webkit-fill-available;
            }

            .app-container {
                padding: 10px; /* å¢åŠ ä¸€ç‚¹paddingä½†ä¸è¿‡å¤š */
                min-height: 100vh;
                min-height: -webkit-fill-available;
                max-width: 100%;
                overflow-x: hidden;
            }

            /* ç¡®ä¿mainå®¹å™¨èƒ½æ­£ç¡®æ»šåŠ¨ */
            main {
                overflow-y: auto;
                flex: 1;
            }

            /* ç§»åŠ¨ç«¯æŒ‰é’®è§¦æ‘¸ä¼˜åŒ– */
            .mode-btn, .nav-item, .add-to-cart, .checkout-btn, .flavor-option, .quantity-btn {
                min-height: 44px;
                touch-action: manipulation;
            }

            /* é˜²æ­¢æ¨ªå‘æ»šåŠ¨ */
            * {
                box-sizing: border-box;
            }

            .main-content {
                width: 100%;
                max-width: 100vw;
                overflow-x: hidden;
            }

            header {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .logo {
                font-size: 18px;
            }

            .main-content {
                display: block !important;
                width: 100%;
            }

            .sidebar {
                width: 100%;
                display: flex;
                overflow-x: auto;
                padding: 8px 0;
                margin-bottom: 10px;
                gap: 5px;
            }

            .nav-item {
                white-space: nowrap;
                padding: 8px 12px;
                font-size: 13px;
                min-width: fit-content;
                flex: 1;
            }

            .content {
                padding: 0;
                width: 100%;
            }

            .product-grid {
                grid-template-columns: 1fr;
                gap: 8px;
                width: 100%;
            }

            .product-card {
                width: 100%;
                max-width: 100%;
            }

            .product-image-container {
                height: 120px;
            }

            .product-info {
                padding: 10px;
            }

            .product-name {
                font-size: 16px;
                margin-bottom: 5px;
            }

            .product-description {
                font-size: 13px;
                margin-bottom: 8px;
                min-height: 35px;
            }

            .product-price {
                font-size: 18px;
                margin-bottom: 8px;
            }

            .add-to-cart {
                width: 100%;
                min-height: 44px;
                margin-top: 8px;
            }

            .product-footer {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }

            .flavor-options {
                flex-direction: column;
                gap: 6px;
            }

            .flavor-option {
                width: 100%;
                padding: 8px;
                text-align: center;
            }

            .order-notes {
                margin-top: 15px;
                padding: 10px;
            }
        }

        @media (max-width: 480px) {
            body {
                font-size: 14px;
                -webkit-text-size-adjust: 100%;
                min-height: 100vh;
                min-height: -webkit-fill-available;
            }

            .app-container {
                padding: 8px; /* é€‚ä¸­çš„padding */
                width: 100%;
                max-width: 100vw;
                min-height: 100vh;
                min-height: -webkit-fill-available;
                overflow-x: hidden;
                overflow-y: auto; /* ç¡®ä¿å‚ç›´æ»šåŠ¨ */
            }

            /* ç¡®ä¿mainèƒ½æ­£ç¡®æ˜¾ç¤ºå†…å®¹ */
            main {
                flex: 1;
                overflow-y: auto;
                padding: 10px; /* mainå†…éƒ¨padding */
            }

            /* å°å±å¹•ä¸¥æ ¼è§¦æ‘¸ä¼˜åŒ– */
            .add-to-cart, .checkout-btn {
                min-height: 48px;
                font-size: 14px;
                touch-action: manipulation;
            }

            .quantity-btn {
                min-width: 44px;
                min-height: 44px;
            }

            /* è¾“å…¥æ¡†ä¼˜åŒ– - é˜²æ­¢iOSè‡ªåŠ¨ç¼©æ”¾ */
            input, textarea, select {
                font-size: 16px !important;
            }

            .product-grid {
                grid-template-columns: 1fr;
                gap: 5px;
                width: 100%;
            }

            .product-card {
                width: 100%;
                max-width: 100vw;
                margin-bottom: 8px;
                overflow: hidden;
            }

            .product-image-container {
                height: 150px;
                width: 100%;
            }

            .product-info {
                padding: 8px;
                width: 100%;
            }

            /* ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ– */
            .add-to-cart, button {
                min-height: 44px;
                padding: 10px 12px;
                font-size: 14px;
                width: 100%;
                touch-action: manipulation;
            }

            /* å•†å“å¡ç‰‡å†…å®¹ä¼˜åŒ– */
            .product-name {
                font-size: 16px;
                margin-bottom: 4px;
                line-height: 1.2;
            }

            .product-description {
                font-size: 12px;
                margin-bottom: 6px;
                min-height: 30px;
                line-height: 1.3;
            }

            .product-notes {
                font-size: 11px;
                padding: 6px 8px;
                margin-bottom: 10px;
                line-height: 1.3;
            }

            .product-price {
                font-size: 16px;
                margin-bottom: 8px;
            }

            .product-footer {
                flex-direction: column;
                gap: 8px;
                align-items: stretch;
                width: 100%;
            }

            /* å£å‘³é€‰æ‹©ä¼˜åŒ– */
            .flavor-selector {
                margin-bottom: 10px;
            }

            .flavor-options {
                display: flex;
                flex-direction: column;
                gap: 6px;
                width: 100%;
            }

            .flavor-option {
                width: 100%;
                padding: 8px;
                min-height: 36px;
                font-size: 13px;
                text-align: center;
                border: 2px solid #ddd;
                margin: 0;
            }

            /* å¯¼èˆªä¼˜åŒ– */
            .nav-item {
                min-height: 40px;
                padding: 6px 8px;
                font-size: 12px;
                flex: 1;
                text-align: center;
                min-width: 70px;
                white-space: nowrap;
            }

            .sidebar {
                display: flex;
                overflow-x: auto;
                gap: 2px;
                padding: 5px 0;
                -webkit-overflow-scrolling: touch;
                width: 100%;
            }

            /* å¤´éƒ¨ä¼˜åŒ– */
            header {
                padding: 8px;
                flex-direction: column;
                gap: 8px;
            }

            .logo {
                font-size: 16px;
            }

            .mode-btn {
                padding: 6px 10px;
                font-size: 12px;
            }

            /* ä¸»å†…å®¹åŒºä¼˜åŒ– */
            main {
                padding: 8px;
                width: 100%;
            }

            .content {
                padding: 0;
                width: 100%;
            }

            /* è´­ç‰©è½¦æ§ä»¶ä¼˜åŒ– */
            .quantity-control {
                display: flex;
                align-items: center;
                gap: 6px;
            }

            .quantity-btn {
                width: 32px;
                height: 32px;
                border-radius: 50%;
                font-size: 14px;
                min-width: 32px;
                min-height: 32px;
            }

            .quantity-input {
                width: 45px;
                height: 32px;
                font-size: 14px;
                text-align: center;
            }

            /* å°æŒ‰é’®ä¼˜åŒ– */
            .small-btn {
                min-height: 30px;
                padding: 5px 10px;
                font-size: 12px;
                touch-action: manipulation;
            }

            /* è¾“å…¥æ¡†ä¼˜åŒ– */
            input, textarea, select {
                font-size: 16px;
            }

            .form-group input, .form-group textarea {
                padding: 10px;
                font-size: 16px;
                min-height: 40px;
            }

            /* è´­ç‰©è½¦é¡¹ç›®ä¼˜åŒ– */
            .cart-item {
                padding: 10px;
                margin-bottom: 10px;
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .cart-item-image {
                width: 100%;
                height: 100px;
                border-radius: 8px;
            }

            .cart-item-info {
                flex: 1;
            }

            .cart-item-controls {
                justify-content: space-between;
                align-items: center;
                margin-top: 8px;
            }

            /* ç»Ÿè®¡å¡ç‰‡ä¼˜åŒ– */
            .stat-card {
                padding: 12px;
                margin-bottom: 8px;
            }

            .stat-value {
                font-size: 20px;
            }

            .stat-label {
                font-size: 12px;
            }

            /* è¡¨æ ¼ä¼˜åŒ– */
            .inventory-table {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                width: 100%;
            }

            .inventory-table table {
                min-width: 500px;
            }

            /* ç§»é™¤å¯èƒ½çš„è¾¹è·å’Œæº¢å‡º */
            * {
                box-sizing: border-box;
            }

            .main-content {
                width: 100%;
                max-width: 100vw;
                overflow-x: hidden;
            }
        }

        /* è¶…å°å±å¹•ä¼˜åŒ– */
        @media (max-width: 360px) {
            .app-container {
                padding: 1px;
            }

            .product-info {
                padding: 6px;
            }

            .product-name {
                font-size: 14px;
            }

            .product-description {
                font-size: 11px;
            }

            .product-price {
                font-size: 14px;
            }

            .add-to-cart {
                font-size: 13px;
                padding: 8px 10px;
                min-height: 40px;
            }

            .flavor-option {
                font-size: 12px;
                padding: 6px;
                min-height: 32px;
            }

            .nav-item {
                font-size: 11px;
                padding: 5px 6px;
                min-height: 36px;
                min-width: 60px;
            }

            header {
                padding: 5px;
            }

            .logo {
                font-size: 14px;
            }

            main {
                padding: 5px;
            }
        }

        /* é€šç”¨ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ– */
        @media (max-width: 1024px) {
            /* è§¦æ‘¸ç›®æ ‡æœ€å°å°ºå¯¸ */
            button, .product-card, .flavor-option, .nav-item, .add-to-cart, .checkout-btn {
                min-height: 44px;
                min-width: 44px;
                touch-action: manipulation;
            }

            /* é˜²æ­¢åŒå‡»ç¼©æ”¾å’Œæ„å¤–ç¼©æ”¾ */
            * {
                -webkit-tap-highlight-color: transparent;
                -webkit-touch-callout: none;
                -webkit-user-select: none;
                user-select: none;
            }

            input, textarea, select {
                -webkit-user-select: text;
                user-select: text;
            }

            /* é˜²æ­¢æ¨ªå‘æ»šåŠ¨å’Œè§†å£é—®é¢˜ */
            body, .app-container, .main-content {
                overflow-x: hidden;
                max-width: 100vw;
            }

            /* ä¿®å¤ç§»åŠ¨ç«¯è§†å£é«˜åº¦é—®é¢˜ */
            html, body {
                height: 100%;
                min-height: 100vh;
                min-height: -webkit-fill-available;
            }

            /* ç¡®ä¿å†…å®¹å®Œå…¨å¯è§ */
            .app-container {
                min-height: 100vh;
                min-height: -webkit-fill-available;
            }

            main {
                flex: 1;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }

            /* ç¡®ä¿å›¾ç‰‡ä¸è¶…å‡ºå®¹å™¨ */
            img {
                max-width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header>
            <div class="logo">
                <span>ğŸ¥</span>
                <span>ä¹é£Ÿå ‚é¢åŒ…åº—</span>
            </div>
            <div class="mode-switcher">
                <button class="mode-btn active" onclick="app.switchMode('user')">ç”¨æˆ·ç«¯</button>
                <button class="mode-btn" onclick="app.switchMode('merchant')">å•†å®¶ç«¯</button>
            </div>
        </header>

        <main class="main-content">
            <!-- ç”¨æˆ·ç«¯ -->
            <div id="userMode" class="mode-content">
                <div style="display: flex; gap: 20px;">
                    <!-- ç”¨æˆ·ä¾§è¾¹æ  -->
                    <aside class="sidebar">
                        <button class="nav-item active" onclick="app.showPage('products')">
                            <span>ğŸ›ï¸</span> å•†å“åˆ—è¡¨
                        </button>
                        <button class="nav-item" onclick="app.showPage('cart')">
                            <span>ğŸ›’</span> è´­ç‰©è½¦
                            <span id="cartCount" style="background: var(--primary-color); color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px;">0</span>
                        </button>
                        <button class="nav-item" onclick="app.showPage('orders')">
                            <span>ğŸ“‹</span> æˆ‘çš„è®¢å•
                        </button>
                        <button class="nav-item" onclick="app.showPage('profile')">
                            <span>ğŸ‘¤</span> ä¸ªäººä¸­å¿ƒ
                        </button>
                    </aside>

                    <!-- ç”¨æˆ·å†…å®¹åŒº -->
                    <div class="content">
                        <!-- å•†å“é¡µé¢ -->
                        <div id="productsPage" class="page active">
                            <h2>æ–°é²œé¢åŒ…</h2>
                            <div class="product-grid" id="productGrid">
                                <!-- å•†å“å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>

                        <!-- è´­ç‰©è½¦é¡µé¢ -->
                        <div id="cartPage" class="page">
                            <h2>è´­ç‰©è½¦</h2>
                            <div class="cart-container" id="cartContainer">
                                <!-- è´­ç‰©è½¦é¡¹ç›®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                            <div class="cart-total" id="cartTotal" style="display: none;">
                                <div class="total-amount">æ€»è®¡ï¼šÂ¥<span id="totalAmount">0</span></div>
                                <button class="checkout-btn" onclick="app.checkout()">å»ç»“ç®—</button>
                            </div>
                            <div class="empty-cart" id="emptyCart" style="text-align: center; padding: 60px 20px; color: var(--text-light);">
                                <h3>ğŸ›’ è´­ç‰©è½¦ç©ºç©ºå¦‚ä¹Ÿ</h3>
                                <p>å¿«å»æŒ‘é€‰ä¸€äº›ç¾å‘³çš„é¢åŒ…å§ï¼</p>
                            </div>
                        </div>

                        <!-- è®¢å•é¡µé¢ -->
                        <div id="ordersPage" class="page">
                            <h2>æˆ‘çš„è®¢å•</h2>
                            <div class="orders-container" id="ordersContainer">
                                <!-- è®¢å•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                            <div class="empty-orders" id="emptyOrders" style="text-align: center; padding: 60px 20px; color: var(--text-light);">
                                <h3>ğŸ“‹ æš‚æ— è®¢å•</h3>
                                <p>æ‚¨è¿˜æ²¡æœ‰ä»»ä½•è®¢å•è®°å½•</p>
                            </div>
                        </div>

                        <!-- ä¸ªäººä¸­å¿ƒé¡µé¢ -->
                        <div id="profilePage" class="page">
                            <h2>ä¸ªäººä¸­å¿ƒ</h2>
                            <div class="order-form">
                                <h3 style="margin-bottom: 20px;">æ”¶è´§åœ°å€</h3>
                                <div class="form-group">
                                    <label>å§“å</label>
                                    <input type="text" id="profileName" placeholder="è¯·è¾“å…¥å§“å">
                                </div>
                                <div class="form-group">
                                    <label>ç”µè¯</label>
                                    <input type="tel" id="profilePhone" placeholder="è¯·è¾“å…¥ç”µè¯">
                                </div>
                                <div class="form-group">
                                    <label>åœ°å€</label>
                                    <textarea id="profileAddress" rows="3" placeholder="è¯·è¾“å…¥è¯¦ç»†åœ°å€"></textarea>
                                </div>
                                
                                <!-- æ–°å¢çš„å¤‡æ³¨æ¡† -->
                                <div class="order-notes">
                                    <label>è®¢å•å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰</label>
                                    <textarea id="orderNotes" placeholder="è¯·è¾“å…¥è®¢å•å¤‡æ³¨ï¼Œä¾‹å¦‚ï¼šç‰¹æ®Šè¦æ±‚ã€é€è¾¾æ—¶é—´ç­‰..."></textarea>
                                </div>
                                
                                <button class="submit-order-btn" onclick="app.submitOrder()">æäº¤è®¢å•</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å•†å®¶ç«¯ -->
            <div id="merchantMode" class="mode-content" style="display: none;">
                <div style="display: flex; gap: 20px;">
                    <!-- å•†å®¶ä¾§è¾¹æ  -->
                    <aside class="sidebar">
                        <button class="nav-item active" onclick="app.showMerchantPage('dashboard', event)">
                            <span>ğŸ“Š</span> æ•°æ®ç»Ÿè®¡
                        </button>
                        <button class="nav-item" onclick="app.showMerchantPage('inventory', event)">
                            <span>ğŸ“¦</span> åº“å­˜ç®¡ç†
                        </button>
                        <button class="nav-item" onclick="app.showMerchantPage('orders', event)">
                            <span>ğŸ“‹</span> è®¢å•ç®¡ç†
                        </button>
                        <button class="nav-item" onclick="app.showMerchantPage('settings', event)">
                            <span>âš™ï¸</span> ç³»ç»Ÿè®¾ç½®
                        </button>
                    </aside>

                    <!-- å•†å®¶å†…å®¹åŒº -->
                    <div class="content">
                        <!-- æ•°æ®ç»Ÿè®¡é¡µé¢ -->
                        <div id="dashboardPage" class="page active">
                            <h2>æ•°æ®ç»Ÿè®¡</h2>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="todaySales">Â¥0</div>
                                    <div class="stat-label">ä»Šæ—¥é”€å”®é¢</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="todayOrders">0</div>
                                    <div class="stat-label">ä»Šæ—¥è®¢å•æ•°</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="totalStock">0</div>
                                    <div class="stat-label">å•†å“åº“å­˜</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="pendingOrders">0</div>
                                    <div class="stat-label">å¾…å¤„ç†è®¢å•</div>
                                </div>
                            </div>
                        </div>

                        <!-- åº“å­˜ç®¡ç†é¡µé¢ -->
                        <div id="inventoryPage" class="page">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h2>åº“å­˜ç®¡ç†</h2>
                                <button class="save-btn" onclick="app.addNewProduct()">æ·»åŠ æ–°å•†å“</button>
                            </div>
                            <div class="inventory-table">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>å•†å“åç§°</th>
                                            <th>å½“å‰åº“å­˜</th>
                                            <th>ä»·æ ¼</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="inventoryTable">
                                        <!-- åº“å­˜æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- è®¢å•ç®¡ç†é¡µé¢ -->
                        <div id="merchantOrdersPage" class="page">
                            <h2>è®¢å•ç®¡ç†</h2>
                            <div class="orders-list" id="merchantOrdersList">
                                <!-- å•†å®¶è®¢å•æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>

                        <!-- ç³»ç»Ÿè®¾ç½®é¡µé¢ -->
                        <div id="settingsPage" class="page">
                            <h2>ç³»ç»Ÿè®¾ç½®</h2>
                            <div class="form-group">
                                <label>åº—é“ºåç§°</label>
                                <input type="text" value="ä¹é£Ÿå ‚é¢åŒ…åº—" placeholder="è¯·è¾“å…¥åº—é“ºåç§°">
                            </div>
                            <div class="form-group">
                                <label>è¥ä¸šæ—¶é—´</label>
                                <input type="text" value="08:00-22:00" placeholder="è¯·è¾“å…¥è¥ä¸šæ—¶é—´">
                            </div>
                            <div class="form-group">
                                <label>è”ç³»ç”µè¯</label>
                                <input type="tel" value="138-0000-0000" placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯">
                            </div>
                            <button class="save-btn">ä¿å­˜è®¾ç½®</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // åº”ç”¨çŠ¶æ€ç®¡ç†
        const app = {
            cart: [],
            userOrders: [],
            products: [
            { id: 1, name: 'è´æœ', description: 'åœ†ç¯å½¢é¢åŒ…ï¼Œå£æ„ŸQå¼¹ï¼Œæœ‰åš¼åŠ²', price: 5, emoji: 'ğŸ¥¯', category: 'classic', stock: 30, 
              image: 'https://imgs.699pic.com/images/600/383/566.jpg!list1x.v2',
              notes: 'ç»å…¸åŸå‘³ï¼Œå¯æ­é…å¥¶æ²¹å¥¶é…ªæˆ–æœé…±',
              flavors: [
                { id: 1, name: 'åŸå‘³è´æœ', price: 5, description: 'ç»å…¸åŸå‘³ï¼Œéº¦é¦™æµ“éƒ' },
                { id: 2, name: 'å…¨éº¦è´æœ', price: 6, description: 'å¥åº·å…¨éº¦ï¼Œä½ç³–ä½è„‚' },
                { id: 3, name: 'èŠéº»è´æœ', price: 6, description: 'é¦™è„†èŠéº»ï¼Œå£æ„Ÿä¸°å¯Œ' }
              ] },
            { id: 2, name: 'åå¸', description: 'æŸ”è½¯ç»†è…»ï¼Œé€‚åˆä¸‰æ˜æ²»ï¼Œæ—©é¤é¦–é€‰', price: 10, emoji: 'ğŸ', category: 'classic', stock: 10,
              image: 'https://images.unsplash.com/photo-1533089860892-a7c6f0a88666?w=400&h=300&fit=crop&crop=center',
              notes: 'åšåˆ‡åå¸ï¼Œçƒ˜ç„™æ¸©åº¦ç²¾å‡†æ§åˆ¶',
              flavors: [
                { id: 1, name: 'ç™½åå¸', price: 10, description: 'ç»å…¸ç™½åå¸ï¼ŒæŸ”è½¯ç»†è…»' },
                { id: 2, name: 'å…¨éº¦åå¸', price: 12, description: 'å¥åº·å…¨éº¦ï¼Œè¥å…»ä¸°å¯Œ' },
                { id: 3, name: 'ç‰›å¥¶åå¸', price: 12, description: 'å¥¶é¦™æµ“éƒï¼Œå£æ„Ÿç»µè½¯' }
              ] },
            { id: 3, name: 'å°åœ†é¢åŒ…', description: 'å°å·§å¯çˆ±ï¼Œæ¾è½¯é¦™ç”œï¼Œé€‚åˆå°æœ‹å‹', price: 5, emoji: 'ğŸ¥¯', category: 'classic', stock: 20,
              image: 'https://images.unsplash.com/photo-1509440159596-0249088772ff?w=400&h=300&fit=crop&crop=center',
              notes: 'è¿·ä½ å°ºå¯¸ï¼Œé€‚åˆå„¿ç«¥ä¸‹åˆèŒ¶',
              flavors: [
                { id: 1, name: 'åŸå‘³å°åœ†åŒ…', price: 5, description: 'ç»å…¸åŸå‘³ï¼Œæ¾è½¯é¦™ç”œ' },
                { id: 2, name: 'å·§å…‹åŠ›å°åœ†åŒ…', price: 6, description: 'å·§å…‹åŠ›é£å‘³ï¼Œç”œè€Œä¸è…»' },
                { id: 3, name: 'è‘¡è„å¹²å°åœ†åŒ…', price: 6, description: 'è‘¡è„å¹²ç‚¹ç¼€ï¼Œå£æ„Ÿä¸°å¯Œ' }
              ] },
            { id: 4, name: 'å½©è‰²é¢åŒ…', description: 'å¤©ç„¶è‰²ç´ åˆ¶ä½œï¼Œè‰²å½©ç¼¤çº·ï¼Œé¢œå€¼æ»¡åˆ†', price: 6, emoji: 'ğŸŒˆ', category: 'creative', stock: 15,
              image: 'https://images.unsplash.com/photo-1528736235302-52922df5c122?w=400&h=300&fit=crop&crop=center',
              notes: 'ä½¿ç”¨æœè”¬ç²‰è°ƒè‰²ï¼Œå¥åº·å®‰å…¨',
              flavors: [
                { id: 1, name: 'å½©è™¹é¢åŒ…', price: 6, description: 'ä¸ƒå½©å½©è™¹ï¼Œé¢œå€¼è¶…é«˜' },
                { id: 2, name: 'æŠ¹èŒ¶é¢åŒ…', price: 7, description: 'æŠ¹èŒ¶é£å‘³ï¼Œæ¸…æ–°å¥åº·' },
                { id: 3, name: 'ç´«è–¯é¢åŒ…', price: 7, description: 'ç´«è–¯å¤©ç„¶ï¼Œè¥å…»ä¸°å¯Œ' }
              ] },
            { id: 5, name: 'æ³•æ£', description: 'ä¼ ç»Ÿæ³•å¼é•¿æ£ï¼Œå¤–è„†å†…è½¯ï¼Œç»å…¸ç™¾æ­', price: 8, emoji: 'ğŸ¥–', category: 'french', stock: 7,
              image: 'https://images.unsplash.com/photo-1549931319-a545dcf3bc73?w=400&h=300&fit=crop&crop=center',
              notes: 'ä¼ ç»Ÿæ³•å¼å·¥è‰ºï¼Œå¤–çš®é…¥è„†',
              flavors: [
                { id: 1, name: 'ç»å…¸æ³•æ£', price: 8, description: 'ä¼ ç»Ÿå·¥è‰ºï¼Œå¤–è„†å†…è½¯' },
                { id: 2, name: 'è’œé¦™æ³•æ£', price: 10, description: 'è’œé¦™æµ“éƒï¼Œé£å‘³ç‹¬ç‰¹' },
                { id: 3, name: 'èŠå£«æ³•æ£', price: 10, description: 'èŠå£«ç‚¹ç¼€ï¼Œå¥¶é¦™åè¶³' }
              ] },
            { id: 6, name: 'ç‰›è§’åŒ…', description: 'å±‚æ¬¡åˆ†æ˜ï¼Œé»„æ²¹é¦™æ°”ï¼Œé…¥è„†å¯å£', price: 6, emoji: 'ğŸ¥', category: 'french', stock: 15,
              image: 'https://img.shetu66.com/2022/12/18/1671372671379175.jpg',
              notes: 'ä½¿ç”¨è¿›å£é»„æ²¹ï¼Œé¦™æ°”æµ“éƒ',
              flavors: [
                { id: 1, name: 'åŸå‘³ç‰›è§’åŒ…', price: 6, description: 'ç»å…¸åŸå‘³ï¼Œé»„æ²¹é¦™æ°”' },
                { id: 2, name: 'æä»ç‰›è§’åŒ…', price: 8, description: 'æä»ç‰‡è£…é¥°ï¼Œå£æ„Ÿä¸°å¯Œ' },
                { id: 3, name: 'å·§å…‹åŠ›ç‰›è§’åŒ…', price: 8, description: 'å·§å…‹åŠ›é¦…æ–™ï¼Œç”œé¦™å¯å£' }
              ] }
        ],

            init() {
                this.loadProductsFromStorage();
                this.renderProducts();
                this.loadCartFromStorage();
                this.loadOrdersFromStorage();
            },

            renderProducts() {
                const productGrid = document.getElementById('productGrid');
                productGrid.innerHTML = '';

                this.products.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    
                    const flavorsHTML = product.flavors ? product.flavors.map((flavor, index) => `
                        <div class="flavor-option ${index === 0 ? 'selected' : ''}" 
                             data-product-id="${product.id}" 
                             data-flavor-id="${flavor.id}"
                             onclick="app.selectFlavor(${product.id}, ${flavor.id})">
                            ${flavor.name}
                            <div class="flavor-price">Â¥${flavor.price}</div>
                        </div>
                    `).join('') : '';
                    
                    productCard.innerHTML = `
                        <div class="product-image-container">
                            <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.onerror=null; this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iI2Y4ZjlmYSIvPjx0ZXh0IHg9IjIwMCIgeT0iMTUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5OTk5OTkiPiTmsqHmnInluIPku7Y8L3RleHQ+PC9zdmc+';">
                            <div class="product-badge">${product.emoji}</div>
                            <div class="product-stock">åº“å­˜: ${product.stock}</div>
                        </div>
                        <div class="product-info">
                            <h3 class="product-name">
                                <span>${product.emoji}</span>
                                ${product.name}
                            </h3>
                            <p class="product-description">${product.description}</p>
                            <div class="product-notes">${product.notes}</div>
                            ${product.flavors ? `
                                <div class="flavor-selector">
                                    <label class="flavor-label">é€‰æ‹©å£å‘³ï¼š</label>
                                    <div class="flavor-options">
                                        ${flavorsHTML}
                                    </div>
                                </div>
                            ` : ''}
                            <div class="product-footer">
                                <div class="product-price" id="price-${product.id}">Â¥${product.price}</div>
                                <button class="add-to-cart" onclick="app.addToCart(${product.id})" ${product.stock === 0 ? 'disabled' : ''}>
                                    ${product.stock === 0 ? 'å·²å”®ç½„' : 'åŠ å…¥è´­ç‰©è½¦'}
                                </button>
                            </div>
                        </div>
                    `;
                    productGrid.appendChild(productCard);
                });
            },

            switchMode(mode) {
                const userMode = document.getElementById('userMode');
                const merchantMode = document.getElementById('merchantMode');
                const userBtns = document.querySelectorAll('.mode-btn');

                if (mode === 'user') {
                    userMode.style.display = 'block';
                    merchantMode.style.display = 'none';
                    userBtns[0].classList.add('active');
                    userBtns[1].classList.remove('active');
                    
                    const userNavItems = userMode.querySelectorAll('.nav-item');
                    const userPages = userMode.querySelectorAll('.page');
                    userNavItems.forEach(item => item.classList.remove('active'));
                    userPages.forEach(page => page.classList.remove('active'));
                    
                    if (userNavItems.length > 0) {
                        userNavItems[0].classList.add('active');
                    }
                    if (userPages.length > 0) {
                        userPages[0].classList.add('active');
                    }
                } else {
                    userMode.style.display = 'none';
                    merchantMode.style.display = 'block';
                    userBtns[0].classList.remove('active');
                    userBtns[1].classList.add('active');
                    
                    const merchantNavItems = merchantMode.querySelectorAll('.nav-item');
                    const merchantPages = merchantMode.querySelectorAll('.page');
                    merchantNavItems.forEach(item => item.classList.remove('active'));
                    merchantPages.forEach(page => page.classList.remove('active'));
                    
                    if (merchantNavItems.length > 0) {
                        merchantNavItems[0].classList.add('active');
                    }
                    if (merchantPages.length > 0) {
                        merchantPages[0].classList.add('active');
                    }
                    
                    this.initMerchantData();
                }
            },

            showPage(page) {
                const pages = document.querySelectorAll('.page');
                const navItems = document.querySelectorAll('.nav-item');

                pages.forEach(p => p.classList.remove('active'));
                navItems.forEach(item => item.classList.remove('active'));

                document.getElementById(page + 'Page').classList.add('active');
                event.target.classList.add('active');

                if (page === 'cart') {
                    this.renderCart();
                } else if (page === 'orders') {
                    this.renderUserOrders();
                }
            },

            selectFlavor(productId, flavorId) {
                const product = this.products.find(p => p.id === productId);
                if (!product || !product.flavors) return;

                const flavorOptions = document.querySelectorAll(`.flavor-option[data-product-id="${productId}"]`);
                flavorOptions.forEach(option => option.classList.remove('selected'));

                const selectedOption = document.querySelector(`.flavor-option[data-product-id="${productId}"][data-flavor-id="${flavorId}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                }

                const selectedFlavor = product.flavors.find(f => f.id === flavorId);
                if (selectedFlavor) {
                    const priceElement = document.getElementById(`price-${productId}`);
                    if (priceElement) {
                        priceElement.textContent = `Â¥${selectedFlavor.price}`;
                    }
                }
            },

            getSelectedFlavor(productId) {
                const product = this.products.find(p => p.id === productId);
                if (!product || !product.flavors) return null;

                const selectedOption = document.querySelector(`.flavor-option.selected[data-product-id="${productId}"]`);
                if (!selectedOption) return product.flavors[0];

                const flavorId = parseInt(selectedOption.getAttribute('data-flavor-id'));
                return product.flavors.find(f => f.id === flavorId) || product.flavors[0];
            },

            addToCart(productId) {
                const product = this.products.find(p => p.id === productId);
                if (product && product.stock > 0) {
                    const selectedFlavor = this.getSelectedFlavor(productId);
                    const flavorName = selectedFlavor ? selectedFlavor.name : product.name;
                    const price = selectedFlavor ? selectedFlavor.price : product.price;
                    
                    const existingItem = this.cart.find(item => 
                        item.productId === productId && 
                        item.flavorId === (selectedFlavor ? selectedFlavor.id : null)
                    );
                    
                    const currentQuantity = existingItem ? existingItem.quantity + 1 : 1;
                    if (product.stock < currentQuantity) {
                        alert(`å•†å“ ${product.name} åº“å­˜ä¸è¶³ï¼å½“å‰åº“å­˜ï¼š${product.stock}`);
                        return;
                    }
                    
                    if (existingItem) {
                        existingItem.quantity += 1;
                    } else {
                        this.cart.push({
                            id: Date.now(),
                            productId: productId,
                            flavorId: selectedFlavor ? selectedFlavor.id : null,
                            productName: product.name,
                            flavorName: flavorName,
                            price: price,
                            quantity: 1,
                            image: product.image,
                            emoji: product.emoji
                        });
                    }
                    
                    alert(`å·²æ·»åŠ  ${flavorName} åˆ°è´­ç‰©è½¦ï¼ä»·æ ¼ï¼šÂ¥${price}`);
                    this.updateCartDisplay();
                    this.saveCartToStorage();
                }
            },

            submitOrder() {
                const name = document.getElementById('profileName').value;
                const phone = document.getElementById('profilePhone').value;
                const address = document.getElementById('profileAddress').value;
                const notes = document.getElementById('orderNotes').value;

                if (!name || !phone || !address) {
                    alert('è¯·å¡«å†™å®Œæ•´çš„æ”¶è´§ä¿¡æ¯ï¼');
                    return;
                }

                if (this.cart.length === 0) {
                    alert('è´­ç‰©è½¦ä¸ºç©ºï¼Œè¯·å…ˆæ·»åŠ å•†å“ï¼');
                    return;
                }

                for (const item of this.cart) {
                    const product = this.products.find(p => p.id === item.productId);
                    if (!product || product.stock < item.quantity) {
                        alert(`å•†å“ ${item.productName} åº“å­˜ä¸è¶³ï¼å½“å‰åº“å­˜ï¼š${product ? product.stock : 0}`);
                        return;
                    }
                }

                for (const item of this.cart) {
                    const product = this.products.find(p => p.id === item.productId);
                    if (product) {
                        product.stock -= item.quantity;
                    }
                }

                const order = {
                    id: Date.now(),
                    customer: name,
                    phone: phone,
                    address: address,
                    notes: notes,
                    items: [...this.cart],
                    total: this.calculateCartTotal(),
                    status: 'pending',
                    time: new Date().toLocaleString('zh-CN')
                };

                this.userOrders.unshift(order);
                this.cart = [];
                this.updateCartDisplay();
                this.saveCartToStorage();
                this.saveOrdersToStorage();
                this.saveProductsToStorage();

                this.renderProducts();
                this.renderInventoryTable();

                document.getElementById('orderNotes').value = '';

                alert('è®¢å•æäº¤æˆåŠŸï¼è¯·ç­‰å¾…å•†å®¶è”ç³»æ‚¨ã€‚' + (notes ? `\næ‚¨çš„å¤‡æ³¨ï¼š${notes}` : ''));
                
                this.updateDashboardStats();
            },

            updateCartDisplay() {
                const cartCount = document.getElementById('cartCount');
                const totalItems = this.cart.reduce((sum, item) => sum + item.quantity, 0);
                cartCount.textContent = totalItems;
            },

            calculateCartTotal() {
                return this.cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            },

            renderCart() {
                const cartContainer = document.getElementById('cartContainer');
                const cartTotal = document.getElementById('cartTotal');
                const emptyCart = document.getElementById('emptyCart');

                if (this.cart.length === 0) {
                    if (cartContainer) cartContainer.style.display = 'none';
                    if (cartTotal) cartTotal.style.display = 'none';
                    if (emptyCart) emptyCart.style.display = 'block';
                    return;
                }

                if (cartContainer) cartContainer.style.display = 'block';
                if (cartTotal) cartTotal.style.display = 'block';
                if (emptyCart) emptyCart.style.display = 'none';

                if (cartContainer) {
                    cartContainer.innerHTML = '';
                    this.cart.forEach(item => {
                        const cartItem = document.createElement('div');
                        cartItem.className = 'cart-item';
                        cartItem.innerHTML = `
                            <img src="${item.image}" alt="${item.productName}" class="cart-item-image" onerror="this.style.display='none'">
                            <div class="cart-item-info">
                                <div class="cart-item-name">${item.emoji} ${item.productName}</div>
                                <div class="cart-item-flavor">${item.flavorName}</div>
                                <div class="cart-item-controls">
                                    <div class="quantity-control">
                                        <button class="quantity-btn" onclick="app.updateQuantity(${item.id}, -1)">-</button>
                                        <input type="number" class="quantity-input" value="${item.quantity}" min="1" onchange="app.setQuantity(${item.id}, this.value)">
                                        <button class="quantity-btn" onclick="app.updateQuantity(${item.id}, 1)">+</button>
                                    </div>
                                </div>
                            </div>
                            <div class="cart-item-price">Â¥${item.price}</div>
                            <button class="small-btn delete-btn" onclick="app.removeFromCart(${item.id})">åˆ é™¤</button>
                        `;
                        cartContainer.appendChild(cartItem);
                    });
                }

                const totalAmountElement = document.getElementById('totalAmount');
                if (totalAmountElement) {
                    totalAmountElement.textContent = this.calculateCartTotal();
                }
            },

            updateQuantity(itemId, change) {
                const item = this.cart.find(item => item.id === itemId);
                if (item) {
                    const newQuantity = item.quantity + change;
                    
                    const product = this.products.find(p => p.id === item.productId);
                    if (product && newQuantity > product.stock) {
                        alert(`å•†å“ ${item.productName} åº“å­˜ä¸è¶³ï¼å½“å‰åº“å­˜ï¼š${product.stock}`);
                        return;
                    }
                    
                    item.quantity = newQuantity;
                    if (item.quantity <= 0) {
                        this.removeFromCart(itemId);
                    } else {
                        this.updateCartDisplay();
                        this.saveCartToStorage();
                        this.renderCart();
                    }
                }
            },

            setQuantity(itemId, quantity) {
                const item = this.cart.find(item => item.id === itemId);
                if (item) {
                    quantity = parseInt(quantity);
                    if (quantity > 0) {
                        const product = this.products.find(p => p.id === item.productId);
                        if (product && quantity > product.stock) {
                            alert(`å•†å“ ${item.productName} åº“å­˜ä¸è¶³ï¼å½“å‰åº“å­˜ï¼š${product.stock}`);
                            document.querySelector(`input[value="${item.quantity}"]`).value = item.quantity;
                            return;
                        }
                        
                        item.quantity = quantity;
                        this.updateCartDisplay();
                        this.saveCartToStorage();
                        this.renderCart();
                    }
                }
            },

            removeFromCart(itemId) {
                this.cart = this.cart.filter(item => item.id !== itemId);
                this.updateCartDisplay();
                this.saveCartToStorage();
                this.renderCart();
            },

            renderUserOrders() {
                const ordersContainer = document.getElementById('ordersContainer');
                const emptyOrders = document.getElementById('emptyOrders');

                if (this.userOrders.length === 0) {
                    if (ordersContainer) ordersContainer.style.display = 'none';
                    if (emptyOrders) emptyOrders.style.display = 'block';
                    return;
                }

                if (ordersContainer) {
                    ordersContainer.style.display = 'block';
                    if (emptyOrders) emptyOrders.style.display = 'none';
                    
                    ordersContainer.innerHTML = '';
                    this.userOrders.forEach(order => {
                        const orderItem = document.createElement('div');
                        orderItem.className = 'user-order-item';
                        
                        let itemsHTML = '';
                        order.items.forEach(item => {
                            itemsHTML += `
                                <div style="padding: 8px 0; border-bottom: 1px solid #f5f5f5;">
                                    <div>${item.emoji} ${item.productName} - ${item.flavorName}</div>
                                    <div style="font-size: 12px; color: #666;">Â¥${item.price} Ã— ${item.quantity}</div>
                                </div>
                            `;
                        });
                        
                        const notesHTML = order.notes ? `
                            <div style="margin-top: 10px; padding: 10px; background: rgba(255, 107, 107, 0.05); border-radius: 6px; border-left: 3px solid var(--primary-color);">
                                <strong>è®¢å•å¤‡æ³¨ï¼š</strong>${order.notes}
                            </div>
                        ` : '';

                        orderItem.innerHTML = `
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
                                <div style="font-size: 16px; font-weight: 600; color: var(--text-dark);">è®¢å•å·ï¼š${order.id}</div>
                                <div style="padding: 6px 12px; border-radius: 15px; font-size: 12px; font-weight: 500; background: rgba(255, 217, 61, 0.2); color: #FFB347; border: 1px solid #FFB347;">
                                    ${order.status === 'pending' ? 'å¾…å¤„ç†' : 
                                      order.status === 'processing' ? 'å¤„ç†ä¸­' : 
                                      order.status === 'completed' ? 'å·²å®Œæˆ' : 'æœªçŸ¥çŠ¶æ€'}
                                </div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                ${itemsHTML}
                            </div>
                            ${notesHTML}
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                                <div style="font-size: 18px; font-weight: bold; color: var(--primary-color);">æ€»è®¡ï¼šÂ¥${order.total}</div>
                                <div style="font-size: 12px; color: var(--text-light);">ä¸‹å•æ—¶é—´ï¼š${order.time}</div>
                            </div>
                        `;
                        ordersContainer.appendChild(orderItem);
                    });
                }
            },

            showMerchantPage(page, event) {
                const pages = document.querySelectorAll('.page');
                const navItems = document.querySelectorAll('.nav-item');

                pages.forEach(p => p.classList.remove('active'));
                navItems.forEach(item => item.classList.remove('active'));

                const pageId = page === 'orders' ? 'merchantOrdersPage' : page + 'Page';
                document.getElementById(pageId).classList.add('active');
                event.target.classList.add('active');

                if (page === 'orders') {
                    this.renderMerchantOrders();
                } else if (page === 'inventory') {
                    this.renderInventoryTable();
                }
            },

            initMerchantData() {
                this.updateDashboardStats();
                this.renderInventoryTable();
                this.renderMerchantOrders();
            },

            updateDashboardStats() {
                const today = new Date().toDateString();
                const todayOrders = this.userOrders.filter(order => 
                    new Date(order.time).toDateString() === today
                );
                
                const todaySales = todayOrders.reduce((sum, order) => sum + order.total, 0);
                const totalStock = this.products.reduce((sum, product) => sum + product.stock, 0);
                const pendingOrders = this.userOrders.filter(order => order.status === 'pending').length;

                document.getElementById('todaySales').textContent = `Â¥${todaySales}`;
                document.getElementById('todayOrders').textContent = todayOrders.length;
                document.getElementById('totalStock').textContent = totalStock;
                document.getElementById('pendingOrders').textContent = pendingOrders;
            },

            renderInventoryTable() {
                const table = document.getElementById('inventoryTable');
                if (!table) return;
                
                table.innerHTML = '';
                
                this.products.forEach(product => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${product.emoji} ${product.name}</td>
                        <td>${product.stock}</td>
                        <td>Â¥${product.price}</td>
                        <td>
                            <button class="small-btn" onclick="app.editProduct(${product.id})">ç¼–è¾‘</button>
                            <button class="small-btn delete-btn" onclick="app.deleteProduct(${product.id})">åˆ é™¤</button>
                        </td>
                    `;
                    table.appendChild(row);
                });
            },

            renderMerchantOrders() {
                const ordersList = document.getElementById('merchantOrdersList');
                if (!ordersList) return;
                
                ordersList.innerHTML = '';
                
                this.userOrders.forEach(order => {
                    const orderItem = document.createElement('div');
                    orderItem.className = 'order-item';
                    
                    let itemsHTML = '';
                    order.items.forEach(item => {
                        itemsHTML += `${item.emoji} ${item.productName} - ${item.flavorName} Ã— ${item.quantity}<br>`;
                    });
                    
                    const notesHTML = order.notes ? `
                        <div style="margin-top: 5px; font-size: 12px; color: #666;">
                            <strong>å¤‡æ³¨ï¼š</strong>${order.notes}
                        </div>
                    ` : '';

                    orderItem.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-weight: 600;">
                            <div>è®¢å•å·ï¼š${order.id}</div>
                            <div style="padding: 4px 12px; border-radius: 15px; font-size: 12px; font-weight: 500; background: rgba(255, 217, 61, 0.2); color: #FFB347; border: 1px solid #FFB347;">
                                ${order.status === 'pending' ? 'å¾…å¤„ç†' : 
                                  order.status === 'accepted' ? 'å·²æ¥å•' : 
                                  order.status === 'delivering' ? 'é…é€ä¸­' : 
                                  order.status === 'completed' ? 'å·²å®Œæˆ' : 'æœªçŸ¥çŠ¶æ€'}
                            </div>
                        </div>
                        <div style="display: flex; gap: 20px; font-size: 14px; color: var(--text-light); margin-bottom: 10px;">
                            <div><strong>å®¢æˆ·ï¼š</strong>${order.customer}</div>
                            <div><strong>ç”µè¯ï¼š</strong>${order.phone}</div>
                            <div><strong>åœ°å€ï¼š</strong>${order.address}</div>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <strong>å•†å“ï¼š</strong><br>${itemsHTML}
                        </div>
                        ${notesHTML}
                        <div style="display: flex; gap: 10px;">
                            <button class="small-btn" onclick="app.updateOrderStatus(${order.id}, 'accepted')">æ¥å•</button>
                            <button class="small-btn" onclick="app.updateOrderStatus(${order.id}, 'delivering')">é…é€</button>
                            <button class="small-btn" onclick="app.updateOrderStatus(${order.id}, 'completed')">å®Œæˆ</button>
                            <button class="small-btn delete-btn" onclick="app.deleteOrder(${order.id})">åˆ é™¤</button>
                        </div>
                    `;
                    ordersList.appendChild(orderItem);
                });
            },

            updateOrderStatus(orderId, status) {
                const order = this.userOrders.find(order => order.id === orderId);
                if (order) {
                    order.status = status;
                    this.saveOrdersToStorage();
                    this.renderMerchantOrders();
                    this.updateDashboardStats();
                    
                    if (document.getElementById('ordersPage').classList.contains('active')) {
                        this.renderUserOrders();
                    }
                }
            },

            deleteOrder(orderId) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè®¢å•å—ï¼Ÿ')) {
                    this.userOrders = this.userOrders.filter(order => order.id !== orderId);
                    this.saveOrdersToStorage();
                    this.renderMerchantOrders();
                    this.updateDashboardStats();
                }
            },

            editProduct(productId) {
                alert('ç¼–è¾‘åŠŸèƒ½éœ€è¦å®Œæ•´çš„æ¨¡æ€æ¡†ä»£ç ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†');
            },

            deleteProduct(productId) {
                if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå•†å“å—ï¼Ÿ')) {
                    this.products = this.products.filter(product => product.id !== productId);
                    this.renderProducts();
                    this.renderInventoryTable();
                }
            },

            addNewProduct() {
                alert('æ·»åŠ å•†å“åŠŸèƒ½éœ€è¦å®Œæ•´çš„æ¨¡æ€æ¡†ä»£ç ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†');
            },

            checkout() {
                this.showPage('profile');
                window.scrollTo(0, 0);
            },

            saveCartToStorage() {
                localStorage.setItem('breadShopCart', JSON.stringify(this.cart));
            },

            loadCartFromStorage() {
                const savedCart = localStorage.getItem('breadShopCart');
                if (savedCart) {
                    this.cart = JSON.parse(savedCart);
                    this.updateCartDisplay();
                }
            },

            saveOrdersToStorage() {
                localStorage.setItem('breadShopOrders', JSON.stringify(this.userOrders));
            },

            loadOrdersFromStorage() {
                const savedOrders = localStorage.getItem('breadShopOrders');
                if (savedOrders) {
                    this.userOrders = JSON.parse(savedOrders);
                }
            },

            saveProductsToStorage() {
                localStorage.setItem('breadShopProducts', JSON.stringify(this.products));
            },

            loadProductsFromStorage() {
                const savedProducts = localStorage.getItem('breadShopProducts');
                if (savedProducts) {
                    this.products = JSON.parse(savedProducts);
                }
            }
        };

        // åˆå§‹åŒ–åº”ç”¨
        document.addEventListener('DOMContentLoaded', function() {
            app.init();
            
            // æ·»åŠ è§¦æ‘¸äº¤äº’ä¼˜åŒ–
            optimizeTouchInteractions();
        });

        // è§¦æ‘¸äº¤äº’ä¼˜åŒ–å‡½æ•°
        function optimizeTouchInteractions() {
            // ä¸ºæ‰€æœ‰å¯ç‚¹å‡»å…ƒç´ æ·»åŠ è§¦æ‘¸åé¦ˆ
            const clickables = document.querySelectorAll('button, .product-card, .flavor-option, .nav-item');
            
            clickables.forEach(element => {
                element.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.95)';
                    this.style.transition = 'transform 0.1s';
                });
                
                element.addEventListener('touchend', function() {
                    this.style.transform = 'scale(1)';
                });
            });
        }
    </script>
</body>
</html>